(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{366:function(e,a,t){"use strict";t.r(a);var s=t(42),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"heroku-server-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#heroku-server-configuration"}},[e._v("#")]),e._v(" heroku server configuration")]),e._v(" "),t("h2",{attrs:{id:"buildpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#buildpack"}},[e._v("#")]),e._v(" buildpack")]),e._v(" "),t("p",[e._v("In order for the image resize & the templates' preview generation to work you will need those build packs IN THAT ORDER:")]),e._v(" "),t("ul",[t("li",[e._v("https://github.com/jontewks/puppeteer-heroku-buildpack.git")]),e._v(" "),t("li",[e._v("heroku/nodejs")])]),e._v(" "),t("p",[e._v("Copy and paste those url in the "),t("code",[e._v("Buildpacks")]),e._v(" section of "),t("code",[e._v("Settings")])]),e._v(" "),t("p",[e._v("This has to be done BEFORE any deploy")]),e._v(" "),t("h2",{attrs:{id:"heroku-features"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#heroku-features"}},[e._v("#")]),e._v(" heroku features")]),e._v(" "),t("p",[e._v("you need to enable "),t("a",{attrs:{href:"https://devcenter.heroku.com/articles/session-affinity",target:"_blank",rel:"noopener noreferrer"}},[e._v("session affinity"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("heroku features:enable http-session-affinity\n")])])]),t("h2",{attrs:{id:"resources"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#resources"}},[e._v("#")]),e._v(" resources")]),e._v(" "),t("p",[e._v("The following are Heroku's Resources.\nThey provide an easy way to install all necessary service but can be omitted if an identical service is provided outside Heroku.")]),e._v(" "),t("h3",{attrs:{id:"mongolab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongolab"}},[e._v("#")]),e._v(" mongolab")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://devcenter.heroku.com/articles/mongolab",target:"_blank",rel:"noopener noreferrer"}},[e._v("mongolab addon's detail"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"sendgrid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sendgrid"}},[e._v("#")]),e._v(" sendgrid")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://devcenter.heroku.com/articles/sendgrid",target:"_blank",rel:"noopener noreferrer"}},[e._v("sendgrid addon's detail"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"logentries"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#logentries"}},[e._v("#")]),e._v(" logentries")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://devcenter.heroku.com/articles/logentries",target:"_blank",rel:"noopener noreferrer"}},[e._v("logentries addon's detail"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("strong",[e._v("You should disable High Response Time")]),e._v("\nThis will error with "),t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSE events"),t("OutboundLink")],1),e._v(" even if there isn't any issue.\nGo to "),t("code",[e._v("Tags and alerts")]),e._v(" and un-check the corresponding line.")]),e._v(" "),t("h2",{attrs:{id:"configuring-heroku-environments-variables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuring-heroku-environments-variables"}},[e._v("#")]),e._v(" configuring heroku environments variables")]),e._v(" "),t("ul",[t("li",[e._v("go in the settings of your application")]),e._v(" "),t("li",[e._v("click on "),t("code",[e._v("settings")])]),e._v(" "),t("li",[e._v("click on "),t("code",[e._v("Reveal Config Vars")])]),e._v(" "),t("li",[e._v("variables name should follow this pattern:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_emailOptions__from\n")])])]),t("ul",[t("li",[e._v("always put "),t("code",[e._v("lepatron_")]),e._v(" first")]),e._v(" "),t("li",[e._v("then each level of config should be seperate with a double underscore: "),t("code",[e._v("__")])]),e._v(" "),t("li",[e._v("see "),t("code",[e._v(".lepatronrc-example")]),e._v(" on the master branch for the config requirements")])]),e._v(" "),t("p",[e._v("below are the common environments variables you should want to set:")]),e._v(" "),t("h3",{attrs:{id:"mail-sending"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mail-sending"}},[e._v("#")]),e._v(" mail sending")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_emailTransport__service         Mailjet\nlepatron_emailTransport__auth__user      your Username (or API key)\nlepatron_emailTransport__auth__pass      your password (or Secret Key)\n")])])]),t("p",[e._v("lepatron_emailTransport__service is for "),t("a",{attrs:{href:"https://www.npmjs.com/package/nodemailer-wellknown",target:"_blank",rel:"noopener noreferrer"}},[e._v("nodemailer-wellknown"),t("OutboundLink")],1),e._v(" configuration")]),e._v(" "),t("h3",{attrs:{id:"from-email-address"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#from-email-address"}},[e._v("#")]),e._v(" from email address")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_emailOptions__from              Badsender Builder <emailbuilder@badsender.com>\n")])])]),t("h3",{attrs:{id:"mongodb-database"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-database"}},[e._v("#")]),e._v(" MongoDB database")]),e._v(" "),t("p",[e._v("the path to your mongoDB instance")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_database                        mongodb://localhost/badsender\n")])])]),t("h3",{attrs:{id:"admin-password"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#admin-password"}},[e._v("#")]),e._v(" Admin password")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_admin__password                 a password of your choice\n")])])]),t("h3",{attrs:{id:"hostname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hostname"}},[e._v("#")]),e._v(" Hostname")]),e._v(" "),t("p",[e._v("The domain name of your app")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_host                            badsender-test.herokuapp.com\n")])])]),t("h3",{attrs:{id:"aws-s3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aws-s3"}},[e._v("#")]),e._v(" AWS S3")]),e._v(" "),t("p",[e._v("Those are the keys you should set for aws")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("lepatron_storage__type                   aws\nlepatron_storage__aws__accessKeyId       20 characters key\nlepatron_storage__aws__secretAccessKey   40 characters secret key\nlepatron_storage__aws__bucketName        your bucket name\nlepatron_storage__aws__region            region of your bucket (ex: ap-southeast-1)\n")])])]),t("h4",{attrs:{id:"getting-an-aws-id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getting-an-aws-id"}},[e._v("#")]),e._v(" getting an AWS id")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://console.aws.amazon.com/iam",target:"_blank",rel:"noopener noreferrer"}},[e._v("console.aws.amazon.com/iam"),t("OutboundLink")],1),e._v(" -> "),t("strong",[e._v("create new access key")])]),e._v(" "),t("h4",{attrs:{id:"creating-the-bucket"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#creating-the-bucket"}},[e._v("#")]),e._v(" creating the bucket")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://console.aws.amazon.com/s3",target:"_blank",rel:"noopener noreferrer"}},[e._v("console.aws.amazon.com/s3"),t("OutboundLink")],1),e._v(" -> "),t("strong",[e._v("create bucket")])]),e._v(" "),t("p",[e._v("you have also to set the good policy for the bucket:")]),e._v(" "),t("p",[t("strong",[e._v("Properties")]),e._v(" -> "),t("strong",[e._v("Permissions")]),e._v(" -> "),t("strong",[e._v("Add bucket policy")])]),e._v(" "),t("p",[e._v("and copy and paste this:")]),e._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2008-10-17"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Statement"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Sid"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"AllowPublicRead"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Effect"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Allow"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Principal"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"AWS"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"*"')]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Action"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s3:GetObject"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Resource"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"arn:aws:s3:::YOURBUCKETNAME/*"')]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("p",[e._v("then replace "),t("code",[e._v("YOURBUCKETNAME")]),e._v(" by your real bucket name")]),e._v(" "),t("h3",{attrs:{id:"other-config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#other-config"}},[e._v("#")]),e._v(" Other config")]),e._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// redirect any http request to https")]),e._v("\nforcessl"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v("       "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\nimages"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// needed only if not using S3 image storage")]),e._v("\n  uploadDir"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v("    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'uploads'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// tmp directory name for image upload")]),e._v("\n  tmpDir"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v("       "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'tmp'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// cache resized images & add cache-control to image request")]),e._v("\n  cache"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v("        "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);